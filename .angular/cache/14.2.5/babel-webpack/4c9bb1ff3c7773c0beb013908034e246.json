{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport * as moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"src/app/core/ui-service/page-loader.service\";\nimport * as i3 from \"src/app/core/storage/storage.service\";\nimport * as i4 from \"src/app/core/services/user.service\";\nimport * as i5 from \"src/app/core/services/app-config.service\";\nimport * as i6 from \"src/app/core/services/request.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../../../core/pipe/number-lead-zero.pipe\";\n\nfunction RequestDetailsPage_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"ion-item\", 11)(2, \"ion-label\", 12)(3, \"div\", 11)(4, \"h2\", 13);\n    i0.ɵɵtext(5, \"# \");\n    i0.ɵɵelementStart(6, \"strong\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"numberLeadZero\");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(9, \"ion-item\", 11)(10, \"ion-label\", 12)(11, \"h3\", 14)(12, \"strong\")(13, \"ion-text\", 15);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"h3\", 16);\n    i0.ɵɵtext(16, \"Status\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(17, \"ion-item\", 11)(18, \"ion-label\", 12)(19, \"div\", 17)(20, \"h1\", 13);\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"h3\", 14);\n    i0.ɵɵtext(23, \"Request Type\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(24, \"ion-item\", 11);\n    i0.ɵɵelement(25, \"ion-icon\", 18);\n    i0.ɵɵelementStart(26, \"ion-label\", 12)(27, \"h2\", 13);\n    i0.ɵɵtext(28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"span\", 16);\n    i0.ɵɵtext(30);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_1_0;\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 6, ctx_r0.details.requestId, 5));\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"color\", (ctx_r0.details.requestStatus.requestStatusId === \"1\" || ctx_r0.details.requestStatus.requestStatusId === \"4\" ? \"danger\" : \"\") || (ctx_r0.details.requestStatus.requestStatusId === \"2\" ? \"primary\" : \"\") || ((tmp_1_0 = ctx_r0.details.requestStatus.requestStatusId === \"3\") !== null && tmp_1_0 !== undefined ? tmp_1_0 : \"tertiary\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.details.requestStatus.name, \" \");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(ctx_r0.details.requestType.name);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(ctx_r0.details.remarks);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.details.remarks !== \"\" ? \"Remarks\" : \"No Remarks\");\n  }\n}\n\nfunction RequestDetailsPage_ng_template_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"ion-item\", 11)(2, \"ion-label\", 12)(3, \"h3\", 14)(4, \"strong\")(5, \"ion-text\");\n    i0.ɵɵelement(6, \"ion-skeleton-text\", 19);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(7, \"h3\", 16);\n    i0.ɵɵelement(8, \"ion-skeleton-text\", 19);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"ion-item\", 11)(10, \"ion-label\", 12)(11, \"div\", 17)(12, \"h1\", 13);\n    i0.ɵɵelement(13, \"ion-skeleton-text\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"h3\", 14);\n    i0.ɵɵelement(15, \"ion-skeleton-text\", 19);\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"animated\", true);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"animated\", true);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"animated\", true);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"animated\", true);\n  }\n}\n\nfunction RequestDetailsPage_ion_button_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-button\", 20);\n    i0.ɵɵlistener(\"click\", function RequestDetailsPage_ion_button_13_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.onClosedRequest());\n    });\n    i0.ɵɵtext(1, \"Closed request\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"disabled\", ctx_r3.isLoading);\n  }\n}\n\nexport let RequestDetailsPage = /*#__PURE__*/(() => {\n  class RequestDetailsPage {\n    constructor(modalCtrl, alertController, actionSheetController, platform, pageLoaderService, storageService, userService, appconfig, requestService) {\n      this.modalCtrl = modalCtrl;\n      this.alertController = alertController;\n      this.actionSheetController = actionSheetController;\n      this.platform = platform;\n      this.pageLoaderService = pageLoaderService;\n      this.storageService = storageService;\n      this.userService = userService;\n      this.appconfig = appconfig;\n      this.requestService = requestService;\n      this.hasChanges = false;\n      this.isLoading = false;\n      this.details = {};\n      this.platform.backButton.subscribeWithPriority(-1, () => {\n        this.cancel();\n      });\n    }\n\n    get requestDate() {\n      return moment(this.details.requestDate).format('dddd, MMM DD, YYYY');\n    }\n\n    ngOnInit() {\n      this.getRequest(this.details.requestId);\n    }\n\n    getRequest(requestId) {\n      return __awaiter(this, void 0, void 0, function* () {\n        try {\n          this.isLoading = true;\n          this.requestService.getById(requestId).subscribe(res => __awaiter(this, void 0, void 0, function* () {\n            if (res.success) {\n              this.details = res.data;\n              this.isLoading = false;\n            } else {\n              yield this.presentAlert({\n                header: 'Try again!',\n                subHeader: '',\n                message: Array.isArray(res.message) ? res.message[0] : res.message,\n                buttons: ['OK']\n              });\n            }\n          }), e => __awaiter(this, void 0, void 0, function* () {\n            yield this.presentAlert({\n              header: 'Try again!',\n              subHeader: '',\n              message: Array.isArray(e.message) ? e.message[0] : e.message,\n              buttons: ['OK']\n            });\n            this.isLoading = false;\n          }));\n        } catch (e) {\n          yield this.presentAlert({\n            header: 'Try again!',\n            subHeader: '',\n            message: Array.isArray(e.message) ? e.message[0] : e.message,\n            buttons: ['OK']\n          });\n        }\n      });\n    }\n\n    onClosedRequest() {\n      return __awaiter(this, void 0, void 0, function* () {\n        yield this.presentAlert({\n          header: 'Are you sure you want to closed?',\n          buttons: [{\n            text: 'BACK',\n            role: 'cancel'\n          }, {\n            text: 'YES',\n            role: 'confirm',\n            handler: () => __awaiter(this, void 0, void 0, function* () {\n              this.closedRequest();\n            })\n          }]\n        });\n      });\n    }\n\n    closedRequest() {\n      return __awaiter(this, void 0, void 0, function* () {\n        try {\n          yield this.pageLoaderService.open('Processing please wait...');\n          this.isLoading = true;\n          this.requestService.updateRequestStatus({\n            requestId: this.details.requestId,\n            requestStatusId: '3'\n          }).subscribe(res => __awaiter(this, void 0, void 0, function* () {\n            if (res.success) {\n              this.hasChanges = true;\n              yield this.pageLoaderService.close();\n              yield this.presentAlert({\n                header: 'Request closed!',\n                buttons: ['OK']\n              });\n              this.isLoading = false;\n              return this.modalCtrl.dismiss(true, 'confirm');\n            } else {\n              yield this.pageLoaderService.close();\n              this.isLoading = false;\n              yield this.presentAlert({\n                header: 'Try again!',\n                message: Array.isArray(res.message) ? res.message[0] : res.message,\n                buttons: ['OK']\n              });\n            }\n          }), err => __awaiter(this, void 0, void 0, function* () {\n            yield this.pageLoaderService.close();\n            this.isLoading = false;\n            yield this.presentAlert({\n              header: 'Try again!',\n              message: Array.isArray(err.message) ? err.message[0] : err.message,\n              buttons: ['OK']\n            });\n          }));\n        } catch (e) {\n          yield this.pageLoaderService.close();\n          this.isLoading = false;\n          yield this.presentAlert({\n            header: 'Try again!',\n            message: Array.isArray(e.message) ? e.message[0] : e.message,\n            buttons: ['OK']\n          });\n        }\n      });\n    }\n\n    cancel() {\n      return this.modalCtrl.dismiss(this.hasChanges ? this.hasChanges : null, 'cancel');\n    }\n\n    presentAlert(options) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const alert = yield this.alertController.create(options);\n        yield alert.present();\n      });\n    }\n\n  }\n\n  RequestDetailsPage.ɵfac = function RequestDetailsPage_Factory(t) {\n    return new (t || RequestDetailsPage)(i0.ɵɵdirectiveInject(i1.ModalController), i0.ɵɵdirectiveInject(i1.AlertController), i0.ɵɵdirectiveInject(i1.ActionSheetController), i0.ɵɵdirectiveInject(i1.Platform), i0.ɵɵdirectiveInject(i2.PageLoaderService), i0.ɵɵdirectiveInject(i3.StorageService), i0.ɵɵdirectiveInject(i4.UserService), i0.ɵɵdirectiveInject(i5.AppConfigService), i0.ɵɵdirectiveInject(i6.RequestService));\n  };\n\n  RequestDetailsPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: RequestDetailsPage,\n    selectors: [[\"app-request-details\"]],\n    decls: 14,\n    vars: 4,\n    consts: [[\"slot\", \"start\"], [3, \"disabled\", \"click\"], [\"name\", \"chevron-back\"], [2, \"text-align\", \"center\"], [\"slot\", \"end\", 2, \"width\", \"48px\"], [1, \"ion-padding\"], [\"class\", \"details-container\", 4, \"ngIf\", \"ngIfElse\"], [\"loading\", \"\"], [1, \"req-controls-bottom\"], [\"color\", \"danger\", \"expand\", \"block\", \"fill\", \"outline\", 3, \"disabled\", \"click\", 4, \"ngIf\"], [1, \"details-container\"], [1, \"item\"], [\"text-wrap\", \"\"], [1, \"title\"], [1, \"sub\"], [3, \"color\"], [1, \"desc\"], [1, \"item\", \"type\"], [\"name\", \"pricetag\", \"slot\", \"start\"], [3, \"animated\"], [\"color\", \"danger\", \"expand\", \"block\", \"fill\", \"outline\", 3, \"disabled\", \"click\"]],\n    template: function RequestDetailsPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0)(3, \"ion-button\", 1);\n        i0.ɵɵlistener(\"click\", function RequestDetailsPage_Template_ion_button_click_3_listener() {\n          return ctx.cancel();\n        });\n        i0.ɵɵelement(4, \"ion-icon\", 2);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"ion-title\", 3);\n        i0.ɵɵtext(6, \"Details\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(7, \"div\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"ion-content\", 5);\n        i0.ɵɵtemplate(9, RequestDetailsPage_div_9_Template, 31, 9, \"div\", 6);\n        i0.ɵɵtemplate(10, RequestDetailsPage_ng_template_10_Template, 16, 4, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 8);\n        i0.ɵɵtemplate(13, RequestDetailsPage_ion_button_13_Template, 2, 1, \"ion-button\", 9);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(11);\n\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", ctx.isLoading);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isLoading)(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.details.requestStatus.requestStatusId === \"1\");\n      }\n    },\n    dependencies: [i7.NgIf, i1.IonButton, i1.IonButtons, i1.IonContent, i1.IonHeader, i1.IonIcon, i1.IonItem, i1.IonLabel, i1.IonSkeletonText, i1.IonText, i1.IonTitle, i1.IonToolbar, i8.NumberLeadZeroPipe],\n    styles: [\"ion-header[_ngcontent-%COMP%]:after{background-image:none}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{color:#000!important;display:flex;flex-direction:column}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{margin:5px 0!important}.details-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{color:#999!important}.details-container[_ngcontent-%COMP%]   .item.type[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:500}.req-controls-bottom[_ngcontent-%COMP%]{position:relative;display:block;width:100%;background:#ffffff;padding:5px 10px;box-shadow:0 3px 10px #0003}.req-controls-bottom[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;font-size:15px}\"]\n  });\n  return RequestDetailsPage;\n})();","map":null,"metadata":{},"sourceType":"module"}