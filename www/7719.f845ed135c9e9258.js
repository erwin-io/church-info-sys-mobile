"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7719],{76:(Z,b,o)=>{o.d(b,{GW:()=>l,dk:()=>g,oK:()=>c});var c=(()=>{return(t=c||(c={})).Prompt="PROMPT",t.Camera="CAMERA",t.Photos="PHOTOS",c;var t})(),l=(()=>{return(t=l||(l={})).Rear="REAR",t.Front="FRONT",l;var t})(),g=(()=>{return(t=g||(g={})).Uri="uri",t.Base64="base64",t.DataUrl="dataUrl",g;var t})()},5641:(Z,b,o)=>{o.d(b,{f:()=>g});var c=o(5e3);let g=(()=>{class t{onClick(){setTimeout(()=>{let u=null,d=document.getElementsByClassName("action-sheet-button");if(d.length>0){for(const i of d)if(i.classList.contains("action-sheet-selected")){u=i;break}}else{d=document.getElementsByClassName("alert-radio-button"),0===d.length&&(d=document.getElementsByClassName("sc-ion-select-popover"));for(const i of d){const f=i.attributes.getNamedItem("aria-checked");if(f&&"true"===f.value){u=i;break}}}u&&u.scrollIntoView({block:"center"})},250)}}return t.\u0275fac=function(u){return new(u||t)},t.\u0275dir=c.lG2({type:t,selectors:[["ion-select"]],hostBindings:function(u,d){1&u&&c.NdJ("click",function(){return d.onClick()})}}),t})()},5045:(Z,b,o)=>{o.d(b,{n:()=>c});class c{isErrorState(g,t){var e,u,d;const i=!(!(null==g?void 0:g.invalid)||!(null===(e=null==g?void 0:g.parent)||void 0===e?void 0:e.dirty)),f=!(!(null===(u=null==g?void 0:g.parent)||void 0===u?void 0:u.invalid)||!(null===(d=null==g?void 0:g.parent)||void 0===d?void 0:d.dirty));return i||f}}},7826:(Z,b,o)=>{o.d(b,{f:()=>n});var c=o(655),l=o(3075),g=o(5045),t=o(5e3),e=o(8386),u=o(8779),d=o(7956),i=o(3746),f=o(9808),M=o(5245),C=o(7322),S=o(7531);function w(a,P){1&a&&(t.TgZ(0,"span",21),t._uU(1," Please enter your password "),t.qZA())}function T(a,P){1&a&&(t.TgZ(0,"span",21),t._uU(1," Password is incorrect "),t.qZA())}function v(a,P){1&a&&(t.TgZ(0,"span",21),t._uU(1," Please enter new password "),t.qZA())}function O(a,P){1&a&&(t.TgZ(0,"span",21),t._uU(1," Confirm Password is required "),t.qZA())}function m(a,P){1&a&&(t.TgZ(0,"span",21),t._uU(1," Password not match "),t.qZA())}let n=(()=>{class a{constructor(_,s,h,p,r){this.userService=_,this.formBuilder=s,this.alertController=h,this.pageLoaderService=p,this.storageService=r,this.activeAditionalBackdrop=!1,this.isSubmitting=!1,this.matcher=new g.n,this.checkPasswords=y=>y.get("newPassword").value===y.get("confirmPassword").value?null:{notSame:!0},this.user=this.storageService.getLoginUser()}get formData(){return Object.assign(Object.assign({},this.changePasswordForm.value),{userId:this.user.userId})}get errorControls(){return this.changePasswordForm.controls}get notSameValueErrorHandler(){return this.changePasswordForm.errors}ngOnInit(){console.log(this.user),this.changePasswordForm=this.formBuilder.group({currentPassword:[null,l.kI.required],newPassword:[null,l.kI.required],confirmPassword:""},{validators:this.checkPasswords}),console.log(this.formData)}onSubmit(){return(0,c.mG)(this,void 0,void 0,function*(){const _=this.formData;if(console.log(_),this.changePasswordForm.valid)try{yield this.presentAlert({header:"Continue?",message:"Are you sure you want to change your password",buttons:[{text:"CANCEL",role:"cancel"},{text:"YES Continue",role:"confirm",handler:()=>{this.save(_)}}]})}catch(s){this.isSubmitting=!1,yield this.pageLoaderService.close(),yield this.presentAlert({header:"Try again!",message:Array.isArray(s.message)?s.message[0]:s.message,buttons:["OK"]})}})}save(_){return(0,c.mG)(this,void 0,void 0,function*(){try{yield this.pageLoaderService.open("Saving..."),this.isSubmitting=!0,this.userService.changePassword(_).subscribe(s=>(0,c.mG)(this,void 0,void 0,function*(){console.log(s),s.success?(yield this.pageLoaderService.close(),yield this.presentAlert({header:"Password changed!",buttons:["OK"]}),this.isSubmitting=!1,this.modal.dismiss(s.data,"confirm")):(this.isSubmitting=!1,yield this.pageLoaderService.close(),this.error=Array.isArray(s.message)?s.message[0]:s.message,yield this.presentAlert({header:"Try again!",message:this.error,buttons:["OK"]}),this.error.toLowerCase().includes("password not match")&&this.changePasswordForm.controls.currentPassword.setErrors({incorrectPassword:!0}))}),s=>(0,c.mG)(this,void 0,void 0,function*(){this.isSubmitting=!1,yield this.pageLoaderService.close(),this.error=Array.isArray(s.message)?s.message[0]:s.message,yield this.presentAlert({header:"Try again!",message:this.error,buttons:["OK"]})}))}catch(s){this.isSubmitting=!1,yield this.pageLoaderService.close(),this.error=Array.isArray(s.message)?s.message[0]:s.message,yield this.presentAlert({header:"Try again!",message:this.error,buttons:["OK"]})}})}close(){this.modal.dismiss(null,"cancel")}presentAlert(_){return(0,c.mG)(this,void 0,void 0,function*(){return yield(yield this.alertController.create(_)).present()})}}return a.\u0275fac=function(_){return new(_||a)(t.Y36(e.K),t.Y36(l.qu),t.Y36(u.Br),t.Y36(d.p),t.Y36(i.V))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-password-and-security"]],decls:49,vars:12,consts:[["no-border","","no-shadow",""],["slot","start"],[3,"click"],["name","chevron-back"],[1,"ion-text-center"],["slot","end",2,"width","48px"],[1,"ion-padding"],["id","petForm",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"form-field-group"],["appearance","outline"],["matInput","","type","password","placeholder","Current Password","formControlName","currentPassword","autocomplete","new-currentPassword"],["currentPassword",""],["matSuffix","",1,"icon-right",2,"cursor","pointer",3,"click"],["class","error",4,"ngIf"],["matInput","","type","password","placeholder","Password","formControlName","newPassword","autocomplete","new-newPassword"],["newPassword",""],["matInput","","type","password","placeholder","Confirm password","formControlName","confirmPassword","autocomplete","new-confirmPassword",3,"errorStateMatcher"],["confirmPassword",""],[1,"controls-bottom"],["type","submit","mat-flat-button","","color","primary","form","petForm",3,"disabled"],[1,"error"]],template:function(_,s){if(1&_){const h=t.EpF();t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.NdJ("click",function(){return s.close()}),t._UZ(4,"ion-icon",3),t.qZA()(),t.TgZ(5,"ion-title",4),t._uU(6,"Password and security"),t.qZA(),t._UZ(7,"div",5),t.qZA()(),t.TgZ(8,"ion-content",6)(9,"form",7),t.NdJ("ngSubmit",function(){return!!s.changePasswordForm.valid&&s.onSubmit()}),t.TgZ(10,"fieldset",8)(11,"div",9)(12,"mat-label"),t._uU(13,"Current Password"),t.qZA(),t.TgZ(14,"mat-form-field",10)(15,"mat-label"),t._uU(16,"Current Password"),t.qZA(),t._UZ(17,"input",11,12),t.TgZ(19,"mat-icon",13),t.NdJ("click",function(){t.CHM(h);const r=t.MAs(18);return t.KtG(r.type="password"===r.type?"text":"password")}),t._uU(20),t.qZA()(),t.YNc(21,w,2,0,"span",14),t.YNc(22,T,2,0,"span",14),t.qZA(),t.TgZ(23,"div",9)(24,"mat-label"),t._uU(25,"New Password"),t.qZA(),t.TgZ(26,"mat-form-field",10)(27,"mat-label"),t._uU(28,"New Password"),t.qZA(),t._UZ(29,"input",15,16),t.TgZ(31,"mat-icon",13),t.NdJ("click",function(){t.CHM(h);const r=t.MAs(30);return t.KtG(r.type="password"===r.type?"text":"password")}),t._uU(32),t.qZA()(),t.YNc(33,v,2,0,"span",14),t.qZA(),t.TgZ(34,"div",9)(35,"mat-label"),t._uU(36,"Confirm Password"),t.qZA(),t.TgZ(37,"mat-form-field",10)(38,"mat-label"),t._uU(39,"Confirm Password"),t.qZA(),t._UZ(40,"input",17,18),t.TgZ(42,"mat-icon",13),t.NdJ("click",function(){t.CHM(h);const r=t.MAs(41);return t.KtG(r.type="password"===r.type?"text":"password")}),t._uU(43),t.qZA()(),t.YNc(44,O,2,0,"span",14),t.YNc(45,m,2,0,"span",14),t.qZA()()()(),t.TgZ(46,"div",19)(47,"ion-button",20),t._uU(48,"Update password"),t.qZA()()}if(2&_){const h=t.MAs(18),p=t.MAs(30),r=t.MAs(41);t.xp6(9),t.Q6J("formGroup",s.changePasswordForm),t.xp6(1),t.Q6J("disabled",s.isSubmitting),t.xp6(10),t.Oqu("password"===h.type?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",s.errorControls.currentPassword.touched&&s.errorControls.currentPassword.errors&&s.errorControls.currentPassword.errors.required),t.xp6(1),t.Q6J("ngIf",s.errorControls.currentPassword.touched&&s.errorControls.currentPassword.errors&&s.errorControls.currentPassword.errors.incorrectPassword),t.xp6(10),t.Oqu("password"===p.type?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",s.errorControls.newPassword.touched&&s.errorControls.newPassword.errors&&s.errorControls.newPassword.errors.required),t.xp6(7),t.Q6J("errorStateMatcher",s.matcher),t.xp6(3),t.Oqu("password"===r.type?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",s.errorControls.confirmPassword.touched&&s.errorControls.confirmPassword.errors&&s.errorControls.confirmPassword.errors.required),t.xp6(1),t.Q6J("ngIf",s.errorControls.confirmPassword.touched&&s.notSameValueErrorHandler&&s.notSameValueErrorHandler.notSame),t.xp6(2),t.Q6J("disabled",!s.changePasswordForm.valid||s.isSubmitting)}},dependencies:[f.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,u.YG,u.Sm,u.W2,u.Gu,u.gu,u.wd,u.sr,M.Hw,C.KE,C.hX,C.R9,S.Nt],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.controls-bottom[_ngcontent-%COMP%]{position:relative;display:block;width:100%;background:#ffffff;padding:5px 10px;box-shadow:0 3px 10px #0003}.controls-bottom[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;font-size:15px;width:100%}"]}),a})()},4787:(Z,b,o)=>{o.d(b,{B:()=>_});var c=o(655),l=o(3075),g=o(5439),e=o(5e3),u=o(8386),d=o(8779),i=o(7956),f=o(3746),M=o(9808),C=o(7322),S=o(7531),w=o(5641);function T(s,h){1&s&&(e.TgZ(0,"span",27),e._uU(1," First name is required "),e.qZA())}function v(s,h){1&s&&(e.TgZ(0,"span",27),e._uU(1," Last name is required "),e.qZA())}function O(s,h){1&s&&(e.TgZ(0,"span",27),e._uU(1," Email is required "),e.qZA())}function m(s,h){1&s&&(e.TgZ(0,"span",27),e._uU(1," Mobile number is required "),e.qZA())}function n(s,h){1&s&&(e.TgZ(0,"span",27),e._uU(1," Address is required "),e.qZA())}function a(s,h){1&s&&e._UZ(0,"ion-datetime",28),2&s&&e.Q6J("showDefaultButtons",!0)}function P(s,h){1&s&&(e.TgZ(0,"span",27),e._uU(1," Please select a gender "),e.qZA())}let _=(()=>{class s{constructor(p,r,y,D,A){this.userService=p,this.formBuilder=r,this.alertController=y,this.pageLoaderService=D,this.storageService=A,this.activeAditionalBackdrop=!1,this.isSubmitting=!1,this.user=this.storageService.getLoginUser()}get formData(){return Object.assign(Object.assign({},this.editProfileForm.value),{userId:this.user.userId})}get isFormDirty(){return this.user.firstName!==this.formData.firstName||this.user.middleName!==this.formData.middleName||this.user.lastName!==this.formData.lastName||this.user.email!==this.formData.email||this.user.mobileNumber!==this.formData.mobileNumber||this.user.address!==this.formData.address||g(this.user.birthDate).format("YYYY-MM-DD")!==g(this.formData.birthDate).format("YYYY-MM-DD")||this.user.gender.genderId!==this.formData.genderId}get errorControls(){return this.editProfileForm.controls}ngOnInit(){console.log(this.user),this.editProfileForm=this.formBuilder.group({firstName:[this.user.firstName,l.kI.required],middleName:[this.user.middleName],lastName:[this.user.lastName,l.kI.required],email:[this.user.email,l.kI.required],mobileNumber:[this.user.mobileNumber,l.kI.required],address:[this.user.address,l.kI.required],birthDate:[new Date(this.user.birthDate).toISOString(),l.kI.required],genderId:[this.user.gender.genderId,l.kI.required]}),console.log(this.formData)}onSubmit(){return(0,c.mG)(this,void 0,void 0,function*(){const p=this.formData;if(console.log(p),this.editProfileForm.valid)try{yield this.presentAlert({header:"Continue?",buttons:[{text:"CANCEL",role:"cancel"},{text:"YES",role:"confirm",handler:()=>{this.save(p)}}]})}catch(r){this.isSubmitting=!1,yield this.pageLoaderService.close(),yield this.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}})}save(p){return(0,c.mG)(this,void 0,void 0,function*(){try{yield this.pageLoaderService.open("Saving..."),this.isSubmitting=!0,this.userService.udpdateClient(p).subscribe(r=>(0,c.mG)(this,void 0,void 0,function*(){r.success?(yield this.pageLoaderService.close(),yield this.presentAlert({header:"Saved!",buttons:["OK"]}),this.isSubmitting=!1,this.user.firstName=r.data.firstName,this.user.middleName=r.data.middleName,this.user.lastName=r.data.lastName,this.user.fullName=r.data.fullName,this.user.email=r.data.email,this.user.mobileNumber=r.data.mobileNumber,this.user.address=r.data.address,this.user.birthDate=new Date(r.data.birthDate),this.user.gender=r.data.gender,this.storageService.saveLoginUser(this.user),this.modal.dismiss(r.data,"confirm")):(this.isSubmitting=!1,yield this.pageLoaderService.close(),yield this.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]}))}),r=>(0,c.mG)(this,void 0,void 0,function*(){this.isSubmitting=!1,yield this.pageLoaderService.close(),yield this.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}))}catch(r){this.isSubmitting=!1,yield this.pageLoaderService.close(),yield this.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}})}close(){this.modal.dismiss(null,"cancel")}presentAlert(p){return(0,c.mG)(this,void 0,void 0,function*(){return yield(yield this.alertController.create(p)).present()})}}return s.\u0275fac=function(p){return new(p||s)(e.Y36(u.K),e.Y36(l.qu),e.Y36(d.Br),e.Y36(i.p),e.Y36(f.V))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-profile-settings"]],decls:82,vars:16,consts:[["no-border","","no-shadow",""],["slot","start"],[3,"click"],["name","chevron-back"],[1,"ion-text-center"],["slot","end",2,"width","48px"],[1,"ion-padding"],["id","petForm",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"form-field-group"],["appearance","outline"],["matInput","","type","text","placeholder","First name","formControlName","firstName","autocomplete","new-firstName"],["class","error",4,"ngIf"],["matInput","","type","text","placeholder","Middle name","formControlName","middleName","autocomplete","new-middleName"],["matInput","","type","text","placeholder","Last name","formControlName","lastName","autocomplete","new-lastName"],["matInput","","type","text","placeholder","Email","formControlName","email","autocomplete","new-email"],["matInput","","type","text","placeholder","Mobile number","formControlName","mobileNumber","autocomplete","new-mobileNumber"],["matInput","","type","text","placeholder","Address","formControlName","address"],["id","open-birthDate-date-picker","fill","outline","lines","none",3,"disabled"],["trigger","open-birthDate-date-picker",3,"cssClass"],["fill","outline",3,"disabled"],["slot","start","formControlName","genderId","placeholder","Select Gender"],["slot","start","value","1"],["slot","start","value","2"],["slot","start","value","3"],[1,"controls-bottom"],["type","submit","mat-flat-button","","color","primary","form","petForm",3,"disabled"],[1,"error"],["presentation","date","size","cover","formControlName","birthDate",3,"showDefaultButtons"]],template:function(p,r){1&p&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),e.NdJ("click",function(){return r.close()}),e._UZ(4,"ion-icon",3),e.qZA()(),e.TgZ(5,"ion-title",4),e._uU(6,"Profile settings"),e.qZA(),e._UZ(7,"div",5),e.qZA()(),e.TgZ(8,"ion-content",6)(9,"form",7),e.NdJ("ngSubmit",function(){return!!r.editProfileForm.valid&&r.onSubmit()}),e.TgZ(10,"fieldset",8)(11,"div",9)(12,"mat-label"),e._uU(13,"First name"),e.qZA(),e.TgZ(14,"mat-form-field",10)(15,"mat-label"),e._uU(16,"First name"),e.qZA(),e._UZ(17,"input",11),e.qZA(),e.YNc(18,T,2,0,"span",12),e.qZA(),e.TgZ(19,"div",9)(20,"mat-label"),e._uU(21,"Middle name"),e.qZA(),e.TgZ(22,"mat-form-field",10)(23,"mat-label"),e._uU(24,"Middle name"),e.qZA(),e._UZ(25,"input",13),e.qZA()(),e.TgZ(26,"div",9)(27,"mat-label"),e._uU(28,"Last name"),e.qZA(),e.TgZ(29,"mat-form-field",10)(30,"mat-label"),e._uU(31,"Last name"),e.qZA(),e._UZ(32,"input",14),e.qZA(),e.YNc(33,v,2,0,"span",12),e.qZA(),e.TgZ(34,"div",9)(35,"mat-label"),e._uU(36,"Email"),e.qZA(),e.TgZ(37,"mat-form-field",10)(38,"mat-label"),e._uU(39,"Email"),e.qZA(),e._UZ(40,"input",15),e.qZA(),e.YNc(41,O,2,0,"span",12),e.qZA(),e.TgZ(42,"div",9)(43,"mat-label"),e._uU(44,"Mobile number"),e.qZA(),e.TgZ(45,"mat-form-field",10)(46,"mat-label"),e._uU(47,"Mobile number"),e.qZA(),e._UZ(48,"input",16),e.qZA(),e.YNc(49,m,2,0,"span",12),e.qZA(),e.TgZ(50,"div",9)(51,"mat-label"),e._uU(52,"Address"),e.qZA(),e.TgZ(53,"mat-form-field",10)(54,"mat-label"),e._uU(55,"Address"),e.qZA(),e._UZ(56,"textarea",17),e.qZA(),e.YNc(57,n,2,0,"span",12),e.qZA(),e.TgZ(58,"div",9)(59,"mat-label",1),e._uU(60,"Birthdate"),e.qZA(),e.TgZ(61,"ion-item",18)(62,"ion-label"),e._uU(63),e.ALo(64,"date"),e.qZA()(),e.TgZ(65,"ion-modal",19),e.YNc(66,a,1,1,"ng-template"),e.qZA()(),e.TgZ(67,"div",9)(68,"mat-label"),e._uU(69,"Gender "),e.qZA(),e.TgZ(70,"ion-item",20)(71,"ion-select",21)(72,"ion-select-option",22),e._uU(73,"Male"),e.qZA(),e.TgZ(74,"ion-select-option",23),e._uU(75,"Female"),e.qZA(),e.TgZ(76,"ion-select-option",24),e._uU(77,"Rather not say"),e.qZA()()(),e.YNc(78,P,2,0,"span",12),e.qZA()()()(),e.TgZ(79,"div",25)(80,"ion-button",26),e._uU(81,"Update"),e.qZA()()),2&p&&(e.xp6(9),e.Q6J("formGroup",r.editProfileForm),e.xp6(1),e.Q6J("disabled",r.isSubmitting),e.xp6(8),e.Q6J("ngIf",r.errorControls.firstName.touched&&r.errorControls.firstName.errors&&r.errorControls.firstName.errors.required),e.xp6(15),e.Q6J("ngIf",r.errorControls.lastName.touched&&r.errorControls.lastName.errors&&r.errorControls.lastName.errors.required),e.xp6(8),e.Q6J("ngIf",r.errorControls.email.touched&&r.errorControls.email.errors&&r.errorControls.email.errors.required),e.xp6(8),e.Q6J("ngIf",r.errorControls.mobileNumber.touched&&r.errorControls.mobileNumber.errors&&r.errorControls.mobileNumber.errors.required),e.xp6(8),e.Q6J("ngIf",r.errorControls.address.touched&&r.errorControls.address.errors&&r.errorControls.address.errors.required),e.xp6(4),e.Q6J("disabled",r.isSubmitting),e.xp6(2),e.Oqu(e.xi3(64,13,r.formData.birthDate,"MMMM dd, yyyy")),e.xp6(2),e.Q6J("cssClass","bottom-end"),e.xp6(5),e.Q6J("disabled",r.isSubmitting),e.xp6(8),e.Q6J("ngIf",r.errorControls.genderId.touched&&r.errorControls.genderId.errors&&r.errorControls.genderId.errors.required),e.xp6(2),e.Q6J("disabled",!r.isFormDirty||r.isSubmitting))},dependencies:[M.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,d.YG,d.Sm,d.W2,d.x4,d.Gu,d.gu,d.Ie,d.Q$,d.t9,d.n0,d.wd,d.sr,d.ki,d.QI,C.KE,C.hX,S.Nt,w.f,M.uU],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.controls-bottom[_ngcontent-%COMP%]{position:relative;display:block;width:100%;background:#ffffff;padding:5px 10px;box-shadow:0 3px 10px #0003}.controls-bottom[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;font-size:15px;width:100%}"]}),s})()},7719:(Z,b,o)=>{o.d(b,{N:()=>T});var c=o(655),l=o(7826),g=o(4787),t=o(7423);const e=(0,t.fo)("Filesystem",{web:()=>o.e(6364).then(o.bind(o,6364)).then(v=>new v.FilesystemWeb)});var u=o(76);const d=(0,t.fo)("Camera",{web:()=>o.e(3954).then(o.bind(o,3954)).then(v=>new v.CameraWeb)});var i=o(5e3),f=o(8779),M=o(8386),C=o(4132),S=o(263),w=o(3746);let T=(()=>{class v{constructor(m,n,a,P,_,s,h,p){this.actionSheetController=m,this.platform=n,this.userService=a,this.router=P,this.authService=_,this.modalCtrl=s,this.storageService=h,this.alertController=p,this.isSubmitting=!1,this.convertBlobToBase64=r=>new Promise((y,D)=>{const A=new FileReader;A.onerror=D,A.onload=()=>{y(A.result)},A.readAsDataURL(r)}),this.user=this.storageService.getLoginUser(),this.platform.backButton.subscribeWithPriority(-1,()=>{this.close()})}ngOnInit(){}onSettingsMenuClick(m){return(0,c.mG)(this,void 0,void 0,function*(){let n=null;switch(m){case"profile-settings":n=yield this.modalCtrl.create({component:g.B,cssClass:"modal-fullscreen",backdropDismiss:!1,canDismiss:!0,componentProps:{modal:n}}),n.onWillDismiss().then(a=>{a.data&&"confirm"===a.role&&(this.user=this.storageService.getLoginUser())}),n.present();break;case"password-and-security":n=yield this.modalCtrl.create({component:l.f,cssClass:"modal-fullscreen",backdropDismiss:!1,canDismiss:!0,componentProps:{modal:n}}),n.present()}})}signout(){this.authService.logout()}ionViewWillEnter(){}close(){this.modal.dismiss(null,"cancel")}toggleDarkMode(){const m=window.matchMedia("(prefers-color-scheme: dark)");this.toggleDarkTheme(m.matches),m.addListener(n=>this.toggleDarkTheme(n.matches))}toggleDarkTheme(m){document.body.classList.toggle("dark",m)}onChangeProfilePic(){return(0,c.mG)(this,void 0,void 0,function*(){const m=yield this.actionSheetController.create({cssClass:"sched-card-action-sheet",buttons:[{text:"Camera",handler:()=>(0,c.mG)(this,void 0,void 0,function*(){const n=yield d.getPhoto({quality:90,allowEditing:!1,resultType:u.dk.Uri,source:u.oK.Camera});if(n){const a=yield this.readAsBase64(n);this.profilePicSource=a,yield this.saveProfilePicture({userId:this.user.userId,userProfilePic:{fileName:`profile-sample-name.${n.format}`,data:a}})}m.dismiss()})},{text:"Gallery",handler:()=>(0,c.mG)(this,void 0,void 0,function*(){const n=yield d.getPhoto({quality:90,allowEditing:!1,resultType:u.dk.Uri,source:u.oK.Photos});if(n){const a=yield this.readAsBase64(n);console.log(a),this.profilePicSource=a,yield this.saveProfilePicture({userId:this.user.userId,userProfilePic:{fileName:`profile-sample-name.${n.format}`,data:a}})}m.dismiss()})},{text:"Cancel",handler:()=>(0,c.mG)(this,void 0,void 0,function*(){m.dismiss()})}]});yield m.present()})}readAsBase64(m){return(0,c.mG)(this,void 0,void 0,function*(){if(this.platform.is("hybrid"))return(yield e.readFile({path:m.path})).data;{const a=yield(yield fetch(m.webPath)).blob();return(yield this.convertBlobToBase64(a)).split(",")[1]}})}profilePicErrorHandler(m){m.target.src="../../../assets/img/profile-not-found.png"}saveProfilePicture(m){return(0,c.mG)(this,void 0,void 0,function*(){try{this.isSubmitting=!0,this.userService.updateClientProfilePicture(m).subscribe(n=>(0,c.mG)(this,void 0,void 0,function*(){console.log(n),n.success?(console.log(n),this.isSubmitting=!1,this.user.gender=n.data.gender,this.user.userProfilePic=n.data.user.userProfilePic.file.url,this.storageService.saveLoginUser(this.user)):(this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(n.message)?n.message[0]:n.message,buttons:["OK"]}))}),n=>(0,c.mG)(this,void 0,void 0,function*(){this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(n.message)?n.message[0]:n.message,buttons:["OK"]})}))}catch(n){this.isSubmitting=!1,yield this.presentAlert({header:"Try again!",message:Array.isArray(n.message)?n.message[0]:n.message,buttons:["OK"]})}})}presentAlert(m){return(0,c.mG)(this,void 0,void 0,function*(){return yield(yield this.alertController.create(m)).present()})}}return v.\u0275fac=function(m){return new(m||v)(i.Y36(f.BX),i.Y36(f.t4),i.Y36(M.K),i.Y36(C.F0),i.Y36(S.e),i.Y36(f.IN),i.Y36(w.V),i.Y36(f.Br))},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-settings"]],decls:32,vars:4,consts:[["no-border","","no-shadow",""],["slot","start"],[3,"click"],["name","chevron-back"],[1,"ion-text-center"],["slot","end",2,"width","48px"],[1,"content"],[1,"row","profile"],[1,"col","avatar"],["id","profilePicture",3,"src","click","error"],[1,"col","welcome"],[1,"row","name"],[1,"row",2,"display","flex"],["lines","none",1,"nav-list"],["slot","start","name","person-outline"],["slot","start","name","shield-checkmark-outline"],["slot","start","name","exit-outline"]],template:function(m,n){1&m&&(i.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),i.NdJ("click",function(){return n.close()}),i._UZ(4,"ion-icon",3),i.qZA()(),i.TgZ(5,"ion-title",4),i._uU(6,"Settings"),i.qZA(),i._UZ(7,"div",5),i.qZA()(),i.TgZ(8,"ion-content")(9,"div",6)(10,"div",7)(11,"div",8)(12,"ion-avatar")(13,"img",9),i.NdJ("click",function(){return n.onChangeProfilePic()})("error",function(P){return n.profilePicErrorHandler(P)}),i.qZA()()(),i.TgZ(14,"div",10)(15,"div",11)(16,"h3"),i._uU(17),i.qZA()()()(),i.TgZ(18,"div",12)(19,"ion-list",13)(20,"ion-item",2),i.NdJ("click",function(){return n.onSettingsMenuClick("profile-settings")}),i._UZ(21,"ion-icon",14),i.TgZ(22,"ion-label"),i._uU(23,"Profile Settings"),i.qZA()(),i.TgZ(24,"ion-item",2),i.NdJ("click",function(){return n.onSettingsMenuClick("password-and-security")}),i._UZ(25,"ion-icon",15),i.TgZ(26,"ion-label"),i._uU(27,"Password and security"),i.qZA()(),i.TgZ(28,"ion-item",2),i.NdJ("click",function(){return n.signout()}),i._UZ(29,"ion-icon",16),i.TgZ(30,"ion-label"),i._uU(31,"Sign Out"),i.qZA()()()()()()),2&m&&(i.xp6(13),i.Akn(n.isSubmitting?"opacity: 0.2":"opacity: 1"),i.Q6J("src",n.user.userProfilePic,i.LSH),i.xp6(4),i.Oqu(n.user.fullName))},dependencies:[f.BJ,f.YG,f.Sm,f.W2,f.Gu,f.gu,f.Ie,f.Q$,f.q_,f.wd,f.sr],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.content[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-grow:1}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{display:flex}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{margin-top:10px;flex-direction:column;align-items:center}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{display:flex;padding:5px}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:103px;height:103px}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-position:center;object-fit:contain;box-shadow:0 0 10px #7a7a7a75}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .welcome[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;row-gap:11px}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .welcome[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;display:flex;flex-direction:column;justify-content:flex-end}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .welcome[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{font-weight:700;color:#000;letter-spacing:0px;line-height:1.2}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .welcome[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .welcome[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:#000;letter-spacing:0px;line-height:1.2}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]{margin-top:40px;flex-direction:column;display:flex;flex-grow:1}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{font-size:20px}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item.active-menu[_ngcontent-%COMP%]::part(native){background-color:#f5f5f5}"]}),v})()}}]);